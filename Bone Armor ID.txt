// Author: Burger
// Description: Auto-ID items in a bag, sort out awesome weapons
// to a seperate bag
// Version: 4-15-2014
// Important:
// 1) You must have an id wand in your hand
// 2) frombag is your bag of unidentified items, tobag is the bag of crap you
//    are going to sell, usually it's in my backpack so there is a weight check..
//    awesomebag is for weapons I want to keep or look closer at..
// 3) comment the next 3 lines to make it not prompt you for new bags each time
if not listexists 'Wands'
  createlist 'Wands'
endif
clearlist 'Wands'
pushlist 'Wands' 0xdf2
pushlist 'Wands' 0xdf3
pushlist 'Wands' 0xdf4
pushlist 'Wands' 0xdf5
if @findlayer self 2
  //undress Dress-1
  @moveitem 'Master Bow' 'Stash Bag'
endif
pause 1000
useobject lootstash
pause 1000
for 0 to 'Wands'
  if @findtype 'Wands[]' 'any' 'lootstash'
    setalias wand found
    equipitem wand 1
    headmsg 'wand'
    break
  endif
endfor
pause 1000
unsetalias 'frombag'
if not @findobject 'frombag'
  headmsg 'Select From Bag'
  promptalias 'frombag'
endif
pause 1000
useobject 'frombag'
pause 700
useobject 'trash'
pause 700
if listexists 'ItemTypes'
  removelist 'ItemTypes'
endif
createlist 'ItemTypes'
clearlist 'ItemTypes'
//Bone and Orc Helm
@pushlist 'ItemTypes' 0x1452 //Bone Legs
@pushlist 'ItemTypes' 0x1450 //Bone Hands
@pushlist 'ItemTypes' 0x144e //Bone Arms
@pushlist 'ItemTypes' 0x144f //Bone Armor
@pushlist 'ItemTypes' 0x1451 //Bone Helm
@pushlist 'ItemTypes' 0x1f0b //Orc Helm
for 0 to 'ItemTypes'
  clearjournal
  while @findtype 'ItemTypes[]' 'any' 'frombag'
    pause 1000
    useobject 'righthand'
    waitfortarget 5000
    target! found
    pause 1000
    if weight >= maxweight
      headmsg 'Go and sell this crap'
      pause 1000
      moveitem wand 'lootstash'
      pause 1000
      stop
    endif
    moveitem found 'trashcontainer'
    pause 500
    if @injournal 'Indestructable/Invulnerability' system
      moveitem found keepchest
      pause 500
    endif
    if @injournal 'out of charges' system
      headmsg 'Out of Charges'
      stop
    endif
  endwhile
endfor
pause 2000
moveitem wand 'lootstash'
stop
